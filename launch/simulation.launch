<launch>

  <arg name="debug" default="false" />

  <arg unless="$(arg debug)" name="launch_prefix" value=""/>
  <arg     if="$(arg debug)" name="launch_prefix" value="gdb -ex run --args"/>

  <arg name="uav_name" default="$(optenv UAV_NAME uav)"/>
  <arg name="world_file" default="$(find mrs_main)/config/world_simulation.yaml"/>

  <!-- <include file="$(find mrs_odometry)/launch/rtk_republisher.launch" /> -->

 <include file="$(find mrs_odometry)/launch/rtk_republisher.launch" />

  <include file="$(find mrs_mavros_interface)/launch/mavros_interface.launch" />

  <group ns="$(arg uav_name)">

    <node pkg="nodelet" type="nodelet" name="odometry" args="load mrs_odometry/Odometry $(arg uav_name)_nodelet_manager" output="screen" launch-prefix="$(arg launch_prefix)">


      <rosparam file="$(find mrs_odometry)/config/simulation.yaml" command="load" />
      <rosparam file="$(arg world_file)" />

      <!-- parameter -->
      <param name="uav_name" type="string" value="$(arg uav_name)"/>
      <param name="simulation" type="bool" value="true"/>
      <param name="use_gt_orientation" type="bool" value="false"/>

      <!-- Subscribers -->
      <remap from="~target_attitude_in" to="mavros/setpoint_raw/target_attitude" />
      <remap from="~pixhawk_odom_in" to="mavros_interface/converted_mavros_odom" />
      <remap from="~optflow_odom_in" to="ground_truth" />
      <remap from="~terarangerone_in" to="teraranger/range" />
      <remap from="~garmin_in" to="garmin/range" />
      <remap from="~global_position_in" to="mavros/global_position/global" />
      <remap from="~tracker_status_in" to="control_manager/tracker_status" />
      <remap from="~rtk_gps_in" to="rtk_gps/global" />
      <remap from="~object_altitude_in" to="landing_object_controller/current_target" />
      <remap from="~icp_relative_in" to="forest_slam/odom_corr" />
      <remap from="~icp_global_in" to="forest_slam/odom_corr_global" />
      <remap from="~ground_truth_in" to="ground_truth" />

      <!-- Publishers -->
      <remap from="~new_odom_out" to="~new_odom" />
      <remap from="~profiler_out" to="profiler" />
      <remap from="~rtk_local_out" to="~rtk_local" />

      <!-- Services -->
      <remap from="~toggle_teraranger" to="~toggle_teraranger" />
      <remap from="~toggle_rtk_altitude" to="~toggle_rtk_altitude" />

    </node>

  </group>

</launch>
